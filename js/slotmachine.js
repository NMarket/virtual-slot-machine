function virtualSlotMachine(){"use strict";function a(){var a=new Stats;return a.setMode(0),a.domElement.style.position="absolute",a.domElement.style.left="0px",a.domElement.style.top="0px",document.body.appendChild(a.domElement),a}function b(a){var b=new THREE.Vector3(a.clientX/window.innerWidth*2-1,2*-(a.clientY/window.innerHeight)+1,.5);b=b.unproject(n);var c=new THREE.Raycaster(n.position,b.sub(n.position).normalize()),d=c.intersectObjects([D]);1===d.length&&(D.position.y=-15,0===i&&(i=1))}function c(){D.position.y=-14}function d(){var a=[];d.prototype.generate=function(){var b=0;for(b=0;3>b;b+=1)a[b]=Math.floor(40*Math.random())},d.prototype.getNumber=function(b){return a[b]<=4?0:5===a[b]?1:6===a[b]?2:a[b]>=7&&a[b]<=17?3:18===a[b]?4:19===a[b]?5:a[b]>=20&&a[b]<=38?6:39===a[b]?7:void 0}}function e(){return 6===v[0].XXstopSegment&&6===v[1].XXstopSegment&&6===v[2].XXstopSegment?5:3===v[0].XXstopSegment&&3===v[1].XXstopSegment&&3===v[2].XXstopSegment?10:0===v[0].XXstopSegment&&0===v[1].XXstopSegment&&0===v[2].XXstopSegment?30:0}function f(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function g(){l.update();var a=I.getDelta();G.update(a);var b=typeof v[2];if("undefined"!==b){var c;switch(i){case 0:break;case 1:for(c=0;3>c;c+=1)v[c].XXspinUntil=I.getElapsedTime()+2*c+3,v[c].XXstopSegment=H.getNumber(c);i=2,j+=1,document.getElementById("gamesPlayed").innerHTML="Credits Played: "+j;break;case 2:for(c=0;3>c;c+=1)if(v[c].XXsegment===v[c].XXstopSegment&&v[c].XXspinUntil<I.getElapsedTime())v[c].rotation.x=v[c].XXsegment*h-.2,2===c&&(i=3);else{for(v[c].XXposition+=3*a;v[c].XXposition>2*Math.PI;)v[c].XXposition-=2*Math.PI;v[c].rotation.x=v[c].XXposition-.2,v[c].XXsegment=Math.floor(v[c].XXposition/h)}break;case 3:i=0!==e()?4:0;break;case 4:for(J=[],K=[],L=[],M=0,N=e(),O=[],P=0,M=0;N>M;M+=1)L[M]=new THREE.Mesh(E,F),L[M].rotation.z=50*Math.random(),L[M].castShadow=!0,L[M].position.x=(M+.5)*(40/N)-20,J[M]=Math.PI,K[M]=.5*Math.random()+1,O[M]=!1,m.add(L[M]);i=5;break;case 5:for(M=0;N>M;M+=1)J[M]<2*Math.PI?(J[M]+=a*K[M],L[M].position.z=24+12*Math.cos(J[M]),L[M].position.y=-4+20*Math.abs(Math.sin(J[M])),L[M].rotation.z+=a):O[M]===!1&&(m.remove(L[M]),P+=1,O[M]=!0,console.log(P));P>=N&&(k+=N,document.getElementById("creditsWon").innerHTML="Credits Won: "+k,J=[],K=[],L=[],i=0,console.log("coinDone: "+P),console.log("amtwon: "+N))}}H.generate(),window.requestAnimationFrame(g),o.render(m,n)}var h=Math.PI/4,i=0,j=0,k=0,l=a(),m=new THREE.Scene,n=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),o=new THREE.WebGLRenderer;o.setClearColor(new THREE.Color(12119551,1)),o.setSize(window.innerWidth,window.innerHeight),o.shadowMapEnabled=!0;var p=new THREE.PlaneBufferGeometry(150,150),q=new THREE.MeshLambertMaterial({color:12320512}),r=new THREE.Mesh(p,q);r.receiveShadow=!0,r.rotation.x=-.5*Math.PI,r.position.x=0,r.position.y=-15,r.position.z=0,m.add(r),n.position.x=25,n.position.y=10,n.position.z=60,n.lookAt(m.position);var s=new THREE.AmbientLight(3355443);m.add(s);var t=new THREE.SpotLight(16777215);t.position.set(20,50,100),t.castShadow=!0,m.add(t);var u,v=[];u=new THREE.JSONLoader,u.load("js/wheel.json",function(a,b){var c=0;for(c=0;3>c;c+=1)v[c]=new THREE.Mesh(a,new THREE.MeshFaceMaterial(b)),v[c].scale.x=10,v[c].scale.y=10,v[c].scale.z=10,v[c].position.x=10*c-10,v[c].castShadow=!0,m.add(v[c]),v[c].XXsegment=0,v[c].XXposition=0,v[c].XXspinUntil=0,v[c].XXstopSegment=0,v[c].rotation.x=v[c].XXsegment*h-.2});var w=new THREE.CylinderGeometry(.5,.5,30,16),x=new THREE.MeshLambertMaterial({color:65280,ambient:65280}),y=new THREE.Mesh(w,x);y.rotation.z=-.5*Math.PI,y.position.z=9.2,y.position.y=-5,y.castShadow=!0,m.add(y);var z=new THREE.Mesh(w,x);z.rotation.z=-.5*Math.PI,z.position.z=9.2,z.position.y=5,z.castShadow=!0,m.add(z);var A=new THREE.BoxGeometry(15,2.5,5),B=THREE.ImageUtils.loadTexture("images/start.png"),C=new THREE.MeshLambertMaterial({color:16776960,ambient:16776960});C.map=B;var D=new THREE.Mesh(A,C);D.position.z=15,D.position.y=-14,D.castShadow=!0,m.add(D);var E=new THREE.CylinderGeometry(3,3,1,18),F=new THREE.MeshLambertMaterial({color:16776960,ambient:16776960}),G=new THREE.OrbitControls(n);G.rotateSpeed=1,G.zoomSpeed=1,G.panSpeed=1,G.noPan=!0,G.maxPolarAngle=Math.PI/2,G.minAzimuthAngle=-Math.PI/2,G.maxAzimuthAngle=Math.PI/2,G.minDistance=25,G.maxDistance=100,window.addEventListener("keydown",function(a){(32===a.keyCode||13===a.keyCode)&&(D.position.y=-15,0===i&&(i=1))},!1),window.addEventListener("keyup",function(a){(32===a.keyCode||13===a.keyCode)&&(D.position.y=-14)},!1),document.addEventListener("mousedown",b,!1),document.addEventListener("mouseup",c,!1),window.addEventListener("resize",f,!1),document.body.appendChild(o.domElement);var H=new d,I=new THREE.Clock,J=[],K=[],L=[],M=0,N=0,O=[],P=0;g()}window.onload=virtualSlotMachine;